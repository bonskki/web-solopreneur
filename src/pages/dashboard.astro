---
import Layout from '../layouts/Layout.astro';
---
<Layout>
  <div class="auth-buttons">
    <button 
      id="login"
      class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors"
    >
      Login with GitHub
    </button>
    <button 
      id="logout"
      class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors ml-4"
    >
      Logout
    </button>
  </div>

  <script>
    // Use dynamic import with error handling
    try {
      const { signIn, signOut } = await import("../lib/auth-client");

      // Type-safe event handling for login
      const loginButton = document.querySelector<HTMLButtonElement>("#login");
      if (loginButton) {
        loginButton.onclick = async () => {
          try {
            const options: any = {
              provider: "github",
              callbackURL: "/dashboard",
            };
            await signIn.social(options);
          } catch (error) {
            console.error("Login failed:", error);
            // You might want to show an error message to the user
          }
        };
      }

      // Type-safe event handling for logout
      const logoutButton = document.querySelector<HTMLButtonElement>("#logout");
      if (logoutButton) {
        logoutButton.onclick = async () => {
          try {
            await signOut();
          } catch (error) {
            console.error("Logout failed:", error);
            // You might want to show an error message to the user
          }
        };
      }
    } catch (error) {
      console.error("Failed to load auth client:", error);
      // You might want to disable the buttons or show an error message
    }
  </script>
</Layout>